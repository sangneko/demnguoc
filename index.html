<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Đếm ngược Ngày lễ Việt Nam</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0f172a;
      color: #f8fafc;
      margin: 0; padding: 20px;
      transition: background 0.3s, color 0.3s;
    }
    h1 { text-align: center; margin-bottom: 20px; }
    header {
      display: flex; flex-wrap: wrap; gap: 10px;
      justify-content: center; margin-bottom: 20px;
    }
    .ctrl { padding: 6px 10px; border-radius: 6px; border: none; }
    input[type="text"], input[type="number"], input[type="date"] {
      padding: 5px; border-radius: 6px; border: 1px solid #ccc;
    }
    #eventList {
      display: grid; grid-template-columns: repeat(auto-fit,minmax(260px,1fr));
      gap: 15px;
    }
    .card {
      background: #1e293b;
      padding: 14px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
      transition: transform 0.2s;
    }
    .card:hover { transform: scale(1.02); }
    .name { font-size: 18px; font-weight: bold; }
    .date { font-size: 14px; color: #94a3b8; margin-top: 4px; }
    .countdown { font-size: 16px; margin-top: 8px; }
    /* Light Theme */
    body.light { background: #f9fafb; color: #111; }
    body.light .card { background: #fff; color: #111; }
    body.light .date { color: #555; }
    /* Form */
    #eventForm {
      display:none; background:#1e293b;
      padding:14px; border-radius:10px; margin-bottom:15px;
    }
    body.light #eventForm { background:#e2e8f0; }
  </style>
</head>
<body>
  <h1>📅 Đếm ngược Ngày lễ Việt Nam</h1>

  <header>
    <label class="ctrl">Năm:
      <input id="yearInput" type="number" min="2024" max="2030" value="2025">
    </label>
    <label class="ctrl">Tìm:
      <input id="searchInput" type="text" placeholder="Ví dụ: Quốc khánh...">
    </label>
    <label class="ctrl">
      <input id="togglePast" type="checkbox" checked> Hiện sự kiện đã qua
    </label>
    <button id="themeToggle" class="ctrl">🌙 Đổi Theme</button>
    <button id="addEventBtn" class="ctrl">➕ Thêm sự kiện</button>
  </header>

  <!-- Form thêm sự kiện -->
  <div id="eventForm">
    <h3>Thêm sự kiện cá nhân</h3>
    <label>Tên: <input id="customName" type="text"></label><br><br>
    <label>Ngày: <input id="customDate" type="date"></label><br><br>
    <button id="saveEvent">Lưu</button>
  </div>

  <div id="eventList"></div>

  <script>
    // --- Danh sách ngày lễ cố định ---
    const HOLIDAYS = [
      { name:"Tết Dương lịch", emoji:"🎉", month:1, day:1 },
      { name:"Ngày Quốc tế Phụ nữ", emoji:"🌸", month:3, day:8 },
      { name:"Giỗ Tổ Hùng Vương", emoji:"👑", month:4, day:18 },
      { name:"Ngày Giải phóng miền Nam", emoji:"🇻🇳", month:4, day:30 },
      { name:"Quốc tế Lao động", emoji:"⚒️", month:5, day:1 },
      { name:"Ngày Quốc tế Thiếu nhi", emoji:"👦👧", month:6, day:1 },
      { name:"Ngày Thương binh Liệt sĩ", emoji:"🕯️", month:7, day:27 },
      { name:"Quốc khánh", emoji:"🎆", month:9, day:2 },
      { name:"Ngày Phụ nữ Việt Nam", emoji:"💐", month:10, day:20 },
      { name:"Ngày Nhà giáo Việt Nam", emoji:"📚", month:11, day:20 },
      { name:"Giáng sinh", emoji:"🎄", month:12, day:25 }
    ];

    // --- Theme toggle ---
    const themeToggle=document.getElementById("themeToggle");
    if(localStorage.getItem("theme")==="light") document.body.classList.add("light");
    themeToggle.addEventListener("click",()=>{
      document.body.classList.toggle("light");
      localStorage.setItem("theme",document.body.classList.contains("light")?"light":"dark");
    });

    // --- Thêm sự kiện cá nhân ---
    const addEventBtn=document.getElementById("addEventBtn");
    const eventForm=document.getElementById("eventForm");
    const saveEvent=document.getElementById("saveEvent");
    addEventBtn.addEventListener("click",()=>{eventForm.style.display=eventForm.style.display==="none"?"block":"none"});
    saveEvent.addEventListener("click",()=>{
      const name=document.getElementById("customName").value;
      const date=document.getElementById("customDate").value;
      if(name && date){
        const events=JSON.parse(localStorage.getItem("customEvents")||"[]");
        events.push({name,emoji:"⭐",absolute:date});
        localStorage.setItem("customEvents",JSON.stringify(events));
        render();
        eventForm.style.display="none";
      }
    });

    // --- Hàm lấy tất cả sự kiện ---
    function getAllEvents(year){
      const customs=JSON.parse(localStorage.getItem("customEvents")||"[]");
      const holidayExpanded = HOLIDAYS.map(e=>{
        if(e.absolute) return e;
        return { ...e, absolute:`${year}-${String(e.month).padStart(2,"0")}-${String(e.day).padStart(2,"0")}` }
      });
      return [...holidayExpanded, ...customs];
    }

    // --- Render danh sách ---
    function render(){
      const list=document.getElementById("eventList");
      list.innerHTML="";
      const year=parseInt(document.getElementById("yearInput").value);
      const search=document.getElementById("searchInput").value.toLowerCase();
      const showPast=document.getElementById("togglePast").checked;
      const now=new Date();

      let events=getAllEvents(year).filter(e=>e.name.toLowerCase().includes(search));
      events=events.map(e=>{
        const d=new Date(e.absolute);
        let diff=Math.floor((d-now)/(1000*60*60*24));
        return { ...e, date:d, diff };
      });
      events=events.filter(e=> showPast || e.diff>=0 );
      events.sort((a,b)=>a.date-b.date);

      events.forEach(ev=>{
        const card=document.createElement("div");
        card.className="card";
        card.innerHTML=`
          <div class="name">${ev.emoji} ${ev.name}</div>
          <div class="date">📅 ${ev.date.toLocaleDateString("vi-VN")}</div>
          <div class="countdown">${ev.diff>=0?`⏳ Còn ${ev.diff} ngày`:`✅ Đã qua ${-ev.diff} ngày`}</div>
        `;
        list.appendChild(card);
      });
    }

    // --- Lắng nghe input ---
    document.getElementById("yearInput").addEventListener("input",render);
    document.getElementById("searchInput").addEventListener("input",render);
    document.getElementById("togglePast").addEventListener("change",render);

    // --- Cập nhật liên tục ---
    setInterval(render,60*1000);
    render();
  </script>
</body>
</html>
